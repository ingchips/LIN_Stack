# lin_driver

* 该文档采用markdown语法编写，请用相关工具打开增强阅读体验；
* 该文档介绍了 __lin驱动__ 测试例程，包含master和slave两个节点的例程；
* lin驱动例程无lin stack协议栈，只进行物理层收发数据的测试；


# 功能介绍
  ## 主节点master的功能：
  * __主节点按键2__：
    * 按下第一次，主节点发送 __FRAME_SLAVE_RECEIVE_DATA__ 帧头，然后继续发送（__txBuff1__）数据，从节点接收并判断数据；
    * 按下第二次，主节点发送 __FRAME_MASTER_RECEIVE_DATA__ 帧头，且要求从节点发送（__txBuff2__）作为应答，主节点接收并判断数据；
    * 再次按下按键，则交替进行以上两个过程；
    * 在以上过程中，会通过RGB灯给予通讯结果的提示，通讯正常亮绿灯，否则亮红灯。这里说的通讯正常，主要包括物理层各字段通讯无异常，同时也包括通讯数据内容符合预期值；
    * 对于主节点向从节点发送数据的过程：
      * 首先，主节点发送帧头，并自查发送帧头是否正确，并进行亮灯提示；从节点收到帧头，也会判断帧头，并进行亮灯提示；
      * 然后，主节点发送数据，并自查发送数据是否正确，并进行亮灯提示；从节点收到数据也会检查，并进行亮灯提示；需要特别说明的是，这里从节点还需要对接收到的数据内容与预期内容比对，并进行亮灯提示；
    * 对于主节点读取从节点应答数据的过程：
      * 首先，主节点发送帧头，并自查发送帧头是否正确，并进行亮灯提示；从节点收到帧头，也会判断帧头，并进行亮灯提示；
      * 然后，从节点发送数据，并自查发送数据是否正确，并进行亮灯提示；主节点收到数据也会检查，并进行亮灯提示；需要特别说明的是，这里主节点还需要对接收到的数据内容与预期内容比对，并进行亮灯提示；
  * __主节点按键3__：
    * 在唤醒状态下，按下按键，则主节点和从节点均进入睡眠状态，RGB灯熄灭；
    * 在睡眠状态下，按下按键，则主节点和从节点均进入唤醒状态，RGB灯显示蓝灯；

  ## 从节点slave的功能：
  * __从节点基本行为__：
    * 一帧数据包含帧头和数据。主节点可以发送帧头和数据，但是从节点只能发送数据，不能发送帧头。基于帧头消息的不同，主节点或从节点将会采取相对应的应答行为。
    * 如果从节点收到 __FRAME_SLAVE_RECEIVE_DATA__ 的帧头，从节点将会接收并校验后续数据（__txBuff1__）。如果接收数据内容与预期内容相同，则从节点会亮绿灯，否则会亮红灯；
    * 如果从节点收到 __FRAME_MASTER_RECEIVE_DATA__ 的帧头，从节点将会以发送（__txBuff2__）数据作为应答数据；

  * __从节点按键2__：
    * 无作用；
  * __从节点按键3__：
    * 在唤醒状态下，无作用；
    * 在休眠状态下，按下按键，则主节点和从节点均进入唤醒状态，RGB灯显示蓝灯；


